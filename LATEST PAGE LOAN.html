<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flow Finance | Institutional Portal</title>
    <style>
        :root {
            --primary: #0f172a; --accent: #2563eb; --success: #059669;
            --bg: #f8fafc; --white: #ffffff; --text: #1e293b; --border: #e2e8f0;
        }

        * { box-sizing: border-box; font-family: 'Inter', system-ui, sans-serif; }
        body { margin: 0; background: var(--bg); color: var(--text); line-height: 1.5; padding-bottom: 80px; }

        /* --- LOGO --- */
        .logo-container { display: flex; align-items: center; gap: 12px; }
        .logo-icon {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            color: white; width: 42px; height: 42px; border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-weight: 800; font-size: 1.4rem; box-shadow: 0 8px 16px -4px rgba(37, 99, 235, 0.4);
        }
        .logo-text { font-size: 1.5rem; font-weight: 800; letter-spacing: -0.5px; color: var(--primary); }
        .logo-text span { color: var(--accent); font-weight: 500; }

        section { display: none; min-height: 100vh; animation: fadeIn 0.4s ease; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* --- AUTH --- */
        .auth-card { 
            max-width: 440px; margin: 8vh auto; background: white; 
            padding: 40px; border-radius: 24px; border: 1px solid var(--border);
            box-shadow: 0 20px 40px rgba(0,0,0,0.05); text-align: center;
        }
        .input-group { text-align: left; margin-bottom: 15px; }
        .input-group label { display: block; font-size: 0.75rem; font-weight: 800; margin-bottom: 5px; color: #64748b; text-transform: uppercase; }
        input { width: 100%; padding: 14px; border: 1px solid var(--border); border-radius: 12px; font-size: 1rem; }

        /* --- DASHBOARD --- */
        .header { background: white; padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 100; }
        .main-layout { display: grid; grid-template-columns: 380px 1fr; gap: 30px; padding: 30px 5%; }
        .calc-card { background: white; padding: 30px; border-radius: 24px; border: 1px solid var(--border); position: sticky; top: 100px; }
        
        .bank-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .bank-card { background: white; padding: 25px; border-radius: 20px; border: 1px solid var(--border); text-align: center; transition: 0.3s; }
        .bank-card.selected { border: 2px solid var(--accent); background: #f0f7ff; }

        .btn { padding: 14px 24px; border-radius: 12px; font-weight: 700; cursor: pointer; border: none; transition: 0.2s; width: 100%; }
        .btn-primary { background: var(--accent); color: white; }
        .btn-outline { background: transparent; border: 1px solid #cbd5e1; color: var(--text); }

        /* --- MODAL & TRAY --- */
        .compare-tray { position: fixed; bottom: 0; left: 0; right: 0; background: var(--primary); color: white; padding: 15px 5%; display: none; justify-content: space-between; align-items: center; z-index: 1000; }
        .modal { display: none; position: fixed; inset: 0; background: rgba(15, 23, 42, 0.8); z-index: 2000; backdrop-filter: blur(8px); align-items: center; justify-content: center; }
        .modal-content { background: white; width: 90%; max-width: 900px; border-radius: 24px; padding: 40px; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
        .best-row { background: #f0fdf4; font-weight: 700; color: var(--success); }
    </style>
</head>
<body>

    <section id="signup-sec" class="active">
        <div class="auth-card">
            <div class="logo-container" style="justify-content:center; margin-bottom:20px;">
                <div class="logo-icon">F</div><div class="logo-text">Flow<span>Finance</span></div>
            </div>
            <h2>Create Account</h2>
            <div class="input-group"><label>Name</label><input type="text" id="s-name" placeholder="Full Name"></div>
            <div class="input-group"><label>Email</label><input type="email" id="s-email" placeholder="Email"></div>
            <div class="input-group"><label>Password</label><input type="password" id="s-pass" placeholder="••••••••"></div>
            <button class="btn btn-primary" onclick="handleAuth('signup')">Sign Up</button>
            <p style="margin-top:15px; font-size:0.9rem;">Have account? <a href="#" onclick="nav('login-sec')">Login</a></p>
        </div>
    </section>

    <section id="login-sec">
        <div class="auth-card">
            <h2>Sign In</h2>
            <div class="input-group"><label>Email</label><input type="email" id="l-email" placeholder="Email"></div>
            <div class="input-group"><label>Password</label><input type="password" id="l-pass" placeholder="••••••••"></div>
            <button class="btn btn-primary" onclick="handleAuth('login')">Login</button>
        </div>
    </section>

    <section id="dashboard-sec">
        <div class="header">
            <div class="logo-container"><div class="logo-icon">F</div><div class="logo-text">Flow<span>Finance</span></div></div>
            <div style="display:flex; align-items:center; gap:15px;">
                <span id="user-display" style="font-weight:700;"></span>
                <button onclick="location.reload()" style="background:#fee2e2; color:#ef4444; border:none; padding:8px 12px; border-radius:8px; cursor:pointer;">Logout</button>
            </div>
        </div>

        <div class="main-layout">
            <div class="calc-card">
                <h3 style="margin-top:0">Personalized Calculator</h3>
                
                <div class="input-group">
                    <label>Principal: ₹ <span id="v-amt">1,000,000</span></label>
                    <input type="range" id="i-amt" min="100000" max="10000000" step="100000" value="1000000" oninput="calculate()">
                </div>

                <div class="input-group">
                    <label>Interest Rate (ROI): <span id="v-roi">8.5</span>%</label>
                    <input type="range" id="i-roi" min="5" max="20" step="0.1" value="8.5" oninput="calculate()">
                </div>

                <div class="input-group">
                    <label>Tenure: <span id="v-yrs">5</span> Years</label>
                    <input type="range" id="i-yrs" min="1" max="30" value="5" oninput="calculate()">
                </div>

                <div style="background:#f0f7ff; padding:20px; border-radius:15px; text-align:center; margin-top:20px; border:1px solid #dbeafe;">
                    <div style="font-size:2rem; color:var(--accent); font-weight:800;" id="emi-out">₹ 20,517</div>
                    <div style="font-size:0.7rem; color:#1e40af; font-weight:700; letter-spacing:1px;">ESTIMATED MONTHLY EMI</div>
                </div>
            </div>
            <div class="bank-grid" id="bank-list"></div>
        </div>
    </section>

    <div id="compare-tray" class="compare-tray">
        <span id="compare-count">0 Selected</span>
        <div style="display:flex; gap:10px;">
            <button class="btn btn-outline" style="color:white; width:auto;" onclick="clearSelection()">Reset</button>
            <button class="btn btn-primary" style="width:auto;" onclick="showComparison()">Compare Offers</button>
        </div>
    </div>

    <div id="compare-modal" class="modal">
        <div class="modal-content">
            <h2 style="margin-top:0">Institutional Analysis</h2>
            <div id="comparison-results"></div>
            <div style="display:flex; gap:10px; margin-top:20px;">
                <button class="btn btn-primary" onclick="downloadReport()" style="width:auto;">Download Quote</button>
                <button class="btn btn-outline" onclick="closeModal()" style="width:auto;">Close</button>
            </div>
        </div>
    </div>

    <script>
        const banks = [
            { n: "ICICI Bank", d: "icicibank.com", c: "#ff9933", r: 8.4 }, { n: "HDFC Bank", d: "hdfcbank.com", c: "#004c8f", r: 8.5 },
            { n: "SBI", d: "onlinesbi.sbi", c: "#28a7e9", r: 8.25 }, { n: "Axis Bank", d: "axisbank.com", c: "#971237", r: 8.6 },
            { n: "Kotak Bank", d: "kotak.com", c: "#ed1c24", r: 8.7 }, { n: "IDFC First", d: "idfcfirstbank.com", c: "#9e1b32", r: 8.5 },
            { n: "IndusInd", d: "indusind.com", c: "#8b2031", r: 8.9 }, { n: "Yes Bank", d: "yesbank.in", c: "#0054a6", r: 9.2 },
            { n: "HSBC Bank", d: "hsbc.co.in", c: "#db0011", r: 8.3 }, { n: "Standard Chartered", d: "sc.com", c: "#00a546", r: 8.4 },
            { n: "DBS Bank", d: "dbs.com", c: "#ff0000", r: 8.2 }, { n: "PNB", d: "pnbindia.in", c: "#811c2e", r: 8.8 },
            { n: "Bank of Baroda", d: "bankofbaroda.in", c: "#f68b1e", r: 8.6 }, { n: "Canara Bank", d: "canarabank.com", c: "#0091d0", r: 8.75 },
            { n: "Union Bank", d: "unionbankofindia.co.in", c: "#00529b", r: 8.9 }, { n: "RBL Bank", d: "rblbank.com", c: "#005696", r: 9.4 },
            { n: "Federal Bank", d: "federalbank.co.in", c: "#004a80", r: 8.8 }, { n: "Bandhan Bank", d: "bandhanbank.com", c: "#004b85", r: 9.5 },
            { n: "Indian Bank", d: "indianbank.in", c: "#f05a28", r: 8.7 }, { n: "UCO Bank", d: "ucobank.com", c: "#0072bc", r: 8.95 }
        ];

        let selectedBanks = [];

        function nav(id) {
            document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(id === 'dashboard-sec') renderBanks();
        }

        function handleAuth(type) {
            if(type === 'signup') {
                const email = document.getElementById('s-email').value;
                const pass = document.getElementById('s-pass').value;
                const name = document.getElementById('s-name').value;
                if(!email || !pass) return alert("Fill data");
                localStorage.setItem(email, JSON.stringify({name, pass}));
                nav('login-sec');
            } else {
                const email = document.getElementById('l-email').value;
                const pass = document.getElementById('l-pass').value;
                const user = JSON.parse(localStorage.getItem(email));
                if(user && user.pass === pass) {
                    document.getElementById('user-display').innerText = user.name;
                    nav('dashboard-sec');
                } else alert("Error");
            }
        }

        function calculate() {
            let P = document.getElementById('i-amt').value;
            let Roi = document.getElementById('i-roi').value;
            let Y = document.getElementById('i-yrs').value;

            document.getElementById('v-amt').innerText = parseInt(P).toLocaleString();
            document.getElementById('v-roi').innerText = Roi;
            document.getElementById('v-yrs').innerText = Y;

            let R = (Roi / 12) / 100;
            let N = Y * 12;
            let emi = (P * R * Math.pow(1 + R, N)) / (Math.pow(1 + R, N) - 1);
            document.getElementById('emi-out').innerText = "₹ " + Math.round(emi).toLocaleString();
        }

        function renderBanks() {
            const list = document.getElementById('bank-list');
            list.innerHTML = "";
            banks.forEach(b => {
                const isSel = selectedBanks.find(s => s.n === b.n);
                list.innerHTML += `
                    <div class="bank-card ${isSel ? 'selected' : ''}">
                        <div style="background:${b.c}; width:40px; height:40px; border-radius:8px; margin:0 auto 10px; display:flex; align-items:center; justify-content:center; color:white; font-weight:800;">${b.n[0]}</div>
                        <h4 style="margin:0">${b.n}</h4>
                        <div style="color:${b.c}; font-weight:800; margin:10px 0;">${b.r}% ROI</div>
                        <div style="display:flex; gap:5px;">
                            <button class="btn btn-outline" style="padding:8px; font-size:0.7rem;" onclick="toggleCompare('${b.n}')">${isSel ? 'Remove' : 'Compare'}</button>
                            <button class="btn btn-primary" style="padding:8px; font-size:0.7rem; background:${b.c};" onclick="window.open('https://${b.d}')">Apply</button>
                        </div>
                    </div>`;
            });
        }

        function toggleCompare(name) {
            const b = banks.find(x => x.n === name);
            const idx = selectedBanks.findIndex(x => x.n === name);
            if(idx > -1) selectedBanks.splice(idx, 1);
            else if(selectedBanks.length < 3) selectedBanks.push(b);
            document.getElementById('compare-tray').style.display = selectedBanks.length > 0 ? 'flex' : 'none';
            document.getElementById('compare-count').innerText = selectedBanks.length + " Banks Selected";
            renderBanks();
        }

        function clearSelection() { selectedBanks = []; toggleCompare(); }

        function showComparison() {
            const P = document.getElementById('i-amt').value;
            const N = document.getElementById('i-yrs').value * 12;
            let minEmi = Infinity;
            
            selectedBanks.forEach(b => {
                let r = (b.r / 12) / 100;
                b.emi = Math.round((P * r * Math.pow(1 + r, N)) / (Math.pow(1 + r, N) - 1));
                if(b.emi < minEmi) minEmi = b.emi;
            });

            let html = `<table><tr><th>Bank</th><th>ROI</th><th>Monthly EMI</th></tr>`;
            selectedBanks.forEach(b => {
                html += `<tr class="${b.emi === minEmi ? 'best-row' : ''}">
                    <td>${b.n} ${b.emi === minEmi ? '⭐' : ''}</td>
                    <td>${b.r}%</td>
                    <td>₹ ${b.emi.toLocaleString()}</td>
                </tr>`;
            });
            document.getElementById('comparison-results').innerHTML = html + `</table>`;
            document.getElementById('compare-modal').style.display = 'flex';
        }

        function closeModal() { document.getElementById('compare-modal').style.display = 'none'; }

        function downloadReport() {
            let txt = "LOAN QUOTE REPORT\n";
            selectedBanks.forEach(b => txt += `${b.n}: ${b.r}% | EMI: ₹${b.emi}\n`);
            const blob = new Blob([txt], {type: 'text/plain'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'Loan_Comparison.txt';
            a.click();
        }
    </script>
</body>
</html>